DEF IN_PLAY_DRAW_MAP()
    ROOM_MAP = GET_ROOM_MAP(PLAYER_ATLAS_COLUMN,PLAYER_ATLAS_ROW)
    MAP ROOM_MAP,0,0
ENDDEF

DEF IN_PLAY_DRAW_PLAYER()
    SPR CREATURE_SPRITES(SPRITE_DUDE),PLAYER_ROOM_COLUMN*ROOM_CELL_WIDTH,PLAYER_ROOM_ROW*ROOM_CELL_HEIGHT
ENDDEF

DEF IN_PLAY_MOVE_PLAYER()
    IF KEYP CODE_UP THEN
        IF PLAYER_ROOM_ROW>0 THEN 
            PLAYER_ROOM_ROW=PLAYER_ROOM_ROW-1
		ELSE
	        IF PLAYER_ATLAS_ROW>0 THEN 
	            PLAYER_ATLAS_ROW=PLAYER_ATLAS_ROW-1
				PLAYER_ROOM_ROW=ROOM_ROWS-1
	        ENDIF
		ENDIF
    ELSEIF KEYP CODE_DOWN THEN
        IF PLAYER_ROOM_ROW<ROOM_ROWS-1 THEN
            PLAYER_ROOM_ROW=PLAYER_ROOM_ROW+1
		ELSE
	        IF PLAYER_ATLAS_ROW<MAZE_ROWS-1 THEN
 	           PLAYER_ATLAS_ROW=PLAYER_ATLAS_ROW+1
				PLAYER_ROOM_ROW=0
  	        ENDIF
		ENDIF
    ELSEIF KEYP CODE_LEFT THEN
        IF PLAYER_ROOM_COLUMN>0 THEN 
            PLAYER_ROOM_COLUMN=PLAYER_ROOM_COLUMN-1
		ELSE
	        IF PLAYER_ATLAS_COLUMN>0 THEN
				PLAYER_ROOM_COLUMN=ROOM_COLUMNS-1
	            PLAYER_ATLAS_COLUMN=PLAYER_ATLAS_COLUMN-1
	        ENDIF
        ENDIF
    ELSEIF KEYP CODE_RIGHT THEN
        IF PLAYER_ROOM_COLUMN<ROOM_COLUMNS-1 THEN 
            PLAYER_ROOM_COLUMN=PLAYER_ROOM_COLUMN+1
        ELSE
        	IF PLAYER_ATLAS_COLUMN<MAZE_COLUMNS-1 THEN
				PLAYER_ROOM_COLUMN=0
         	    PLAYER_ATLAS_COLUMN=PLAYER_ATLAS_COLUMN+1
	        ENDIF
		ENDIF
    ENDIF
ENDDEF

DEF IN_PLAY_UPDATE(DELTA)
    IN_PLAY_DRAW_MAP()
    IN_PLAY_DRAW_PLAYER()
    IN_PLAY_MOVE_PLAYER()
    RETURN STATE_IN_PLAY
ENDDEF